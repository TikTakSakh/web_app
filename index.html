<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Ğ’Ğ°Ğ½Ğ¸Ğ»ÑŒĞºĞ° â€” ĞœĞ¸Ğ½Ğ¸-Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700&family=Varela+Round&display=swap"
    rel="stylesheet" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    /* â”€â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg: #FFF5F0;
      --bg-card: #FFFFFF;
      --primary: #D4856A;
      --primary-soft: #E8A992;
      --accent: #C2A0D0;
      --accent-soft: #DCCCE5;
      --mint: #A8D5BA;
      --mint-soft: #C5E8D3;
      --cream: #FFF0DB;
      --text: #5A3E36;
      --text-light: #8D7068;
      --text-muted: #B09A93;
      --border: #F0DDD6;
      --shadow: rgba(180, 130, 110, .12);
      --btn-order: linear-gradient(135deg, #D4856A 0%, #C2A0D0 100%);
      --btn-order-hover: linear-gradient(135deg, #C57A60 0%, #B290C0 100%);
      --radius: 16px;
      --radius-sm: 10px;
    }

    html {
      font-size: 16px;
    }

    body {
      font-family: 'Nunito Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 100px;
      -webkit-font-smoothing: antialiased;
    }

    /* â”€â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(255, 245, 240, .85);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      padding: 16px 20px 12px;
      text-align: center;
      border-bottom: 1px solid var(--border);
    }

    .header h1 {
      font-family: 'Varela Round', sans-serif;
      font-size: 1.35rem;
      color: var(--primary);
      letter-spacing: 0.02em;
    }

    .header p {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 2px;
    }

    /* â”€â”€â”€ Catalog â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .catalog {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 16px 16px 0;
    }

    /* â”€â”€â”€ Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius);
      padding: 16px;
      display: flex;
      align-items: center;
      gap: 14px;
      box-shadow: 0 2px 12px var(--shadow);
      border: 1px solid var(--border);
      transition: transform .2s ease, box-shadow .2s ease;
    }

    .card:active {
      transform: scale(.98);
    }

    /* Color accent stripes per card */
    .card .stripe {
      flex-shrink: 0;
      width: 6px;
      height: 54px;
      border-radius: 3px;
    }

    .stripe-pink {
      background: var(--primary-soft);
    }

    .stripe-brown {
      background: #A0755A;
    }

    .stripe-rose {
      background: #E0A0A8;
    }

    .stripe-yellow {
      background: #E8D08A;
    }

    .stripe-orange {
      background: #E8B88A;
    }

    .stripe-cocoa {
      background: #9A7060;
    }

    .card-info {
      flex: 1;
      min-width: 0;
    }

    .card-name {
      font-family: 'Varela Round', sans-serif;
      font-size: 0.95rem;
      font-weight: 400;
      color: var(--text);
      line-height: 1.3;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card-price {
      font-size: 0.8rem;
      color: var(--text-light);
      margin-top: 2px;
    }

    /* â”€â”€â”€ Quantity Controls â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .qty-controls {
      display: flex;
      align-items: center;
      gap: 0;
      flex-shrink: 0;
    }

    .qty-btn {
      width: 36px;
      height: 36px;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 1.15rem;
      font-weight: 700;
      color: var(--primary);
      background: var(--cream);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background .15s ease, transform .1s ease;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }

    .qty-btn:active {
      transform: scale(.9);
      background: var(--border);
    }

    .qty-btn.minus {
      border-radius: var(--radius-sm) 0 0 var(--radius-sm);
    }

    .qty-btn.plus {
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    }

    .qty-value {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 700;
      color: var(--text);
      background: #FFF9F5;
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      user-select: none;
    }

    /* â”€â”€â”€ Footer / Order Button â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 100;
      padding: 12px 16px;
      padding-bottom: max(12px, env(safe-area-inset-bottom));
      background: rgba(255, 245, 240, .92);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-top: 1px solid var(--border);
    }

    .order-summary {
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-light);
      margin-bottom: 8px;
      min-height: 18px;
      transition: opacity .2s ease;
    }

    .order-btn {
      display: block;
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: var(--radius);
      background: var(--btn-order);
      color: #FFF;
      font-family: 'Varela Round', sans-serif;
      font-size: 1rem;
      font-weight: 400;
      letter-spacing: 0.03em;
      cursor: pointer;
      transition: opacity .2s ease, transform .15s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .order-btn:active {
      transform: scale(.97);
    }

    .order-btn:disabled {
      opacity: .4;
      cursor: default;
      transform: none;
    }

    .order-btn:not(:disabled):hover {
      background: var(--btn-order-hover);
    }

    /* â”€â”€â”€ Empty State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .empty-hint {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.85rem;
      padding: 48px 24px;
      line-height: 1.5;
    }

    /* â”€â”€â”€ Animations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card {
      animation: fadeInUp .35s ease both;
    }

    .card:nth-child(1) {
      animation-delay: .03s;
    }

    .card:nth-child(2) {
      animation-delay: .07s;
    }

    .card:nth-child(3) {
      animation-delay: .11s;
    }

    .card:nth-child(4) {
      animation-delay: .15s;
    }

    .card:nth-child(5) {
      animation-delay: .19s;
    }

    .card:nth-child(6) {
      animation-delay: .23s;
    }

    @media (prefers-reduced-motion: reduce) {
      .card {
        animation: none;
      }

      .qty-btn:active,
      .order-btn:active,
      .card:active {
        transform: none;
      }
    }

    /* â”€â”€â”€ Modal Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 200;
      background: rgba(90, 62, 54, .45);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      align-items: flex-end;
      justify-content: center;
    }

    .modal-overlay.active {
      display: flex;
      animation: fadeIn .2s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .modal {
      background: var(--bg-card);
      border-radius: var(--radius) var(--radius) 0 0;
      width: 100%;
      max-width: 420px;
      padding: 24px 20px;
      padding-bottom: max(24px, env(safe-area-inset-bottom));
      box-shadow: 0 -4px 30px rgba(180, 130, 110, .2);
      animation: slideUp .25s ease;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100%);
      }

      to {
        transform: translateY(0);
      }
    }

    .modal-title {
      font-family: 'Varela Round', sans-serif;
      font-size: 1.1rem;
      color: var(--text);
      text-align: center;
      margin-bottom: 20px;
    }

    .modal-field {
      margin-bottom: 16px;
    }

    .modal-label {
      display: block;
      font-size: 0.8rem;
      color: var(--text-light);
      margin-bottom: 6px;
      font-weight: 600;
    }

    .modal-input {
      width: 100%;
      padding: 12px 14px;
      border: 1.5px solid var(--border);
      border-radius: var(--radius-sm);
      font-family: 'Nunito Sans', sans-serif;
      font-size: 0.95rem;
      color: var(--text);
      background: #FFF9F5;
      outline: none;
      transition: border-color .2s ease;
      -webkit-appearance: none;
      appearance: none;
    }

    .modal-input:focus {
      border-color: var(--primary-soft);
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .modal-btn {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: var(--radius-sm);
      font-family: 'Varela Round', sans-serif;
      font-size: 0.95rem;
      cursor: pointer;
      transition: opacity .2s ease, transform .1s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .modal-btn:active {
      transform: scale(.97);
    }

    .modal-btn.cancel {
      background: var(--cream);
      color: var(--text-light);
    }

    .modal-btn.confirm {
      background: var(--btn-order);
      color: #FFF;
    }

    .modal-btn.confirm:disabled {
      opacity: .4;
      cursor: default;
      transform: none;
    }

    /* Time grid */
    .time-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }

    .time-slot {
      padding: 10px 4px;
      border: 1.5px solid var(--border);
      border-radius: var(--radius-sm);
      background: #FFF9F5;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text);
      text-align: center;
      cursor: pointer;
      transition: all .15s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .time-slot:active {
      transform: scale(.95);
    }

    .time-slot.selected {
      background: var(--primary);
      border-color: var(--primary);
      color: #FFF;
    }

    .time-slot.disabled {
      opacity: .3;
      cursor: default;
      pointer-events: none;
    }

    .modal-hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-align: center;
      margin-top: 8px;
    }
  </style>
</head>

<body>

  <header class="header">
    <h1>Ğ’Ğ°Ğ½Ğ¸Ğ»ÑŒĞºĞ°</h1>
    <p>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚Ğ¾Ñ€Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°</p>
  </header>

  <main class="catalog" id="catalog">
    <!-- Cards rendered by JS -->
  </main>

  <footer class="footer">
    <div class="order-summary" id="orderSummary"></div>
    <button class="order-btn" id="orderBtn" disabled>Ğ¡Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ·</button>
  </footer>

  <!-- â”€â”€ Date/Time Picker Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-title">Ğš ĞºĞ°ĞºĞ¾Ğ¼Ñƒ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ğ¼ Ğ·Ğ°ĞºĞ°Ğ·?</div>

      <div class="modal-field">
        <label class="modal-label" for="pickupDate">ğŸ“… Ğ”Ğ°Ñ‚Ğ°</label>
        <input type="date" class="modal-input" id="pickupDate" />
      </div>

      <div class="modal-field">
        <label class="modal-label">ğŸ• Ğ’Ñ€ĞµĞ¼Ñ</label>
        <div class="time-grid" id="timeGrid"></div>
        <div class="modal-hint">ĞŸĞ½â€“ĞŸÑ‚: 12:00â€“20:00 Â· Ğ¡Ğ±: 12:00â€“19:00 Â· Ğ’Ñ: Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹</div>
      </div>

      <div class="modal-actions">
        <button class="modal-btn cancel" id="modalCancel">ĞĞ°Ğ·Ğ°Ğ´</button>
        <button class="modal-btn confirm" id="modalConfirm" disabled>ĞÑ„Ğ¾Ñ€Ğ¼Ğ¸Ñ‚ÑŒ</button>
      </div>
    </div>
  </div>

  <script>
    /* â”€â”€ Catalog Data (from Google Drive knowledge base) â”€â”€â”€â”€ */
    const CATALOG = [
      { id: 1, name: "ĞšĞ»ÑƒĞ±Ğ½Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ¼ĞµÑ‡Ñ‚Ğ°", price: 650, stripe: "stripe-pink" },
      { id: 2, name: "Ğ¨Ğ¾ĞºĞ¾Ğ»Ğ°Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ¿ÑƒÑ‡Ğ¸Ğ½Ğ¾", price: 700, stripe: "stripe-brown" },
      { id: 3, name: "ĞœĞ°Ğ»Ğ¸Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ€Ğ°ÑÑĞ²ĞµÑ‚", price: 680, stripe: "stripe-rose" },
      { id: 4, name: "Ğ›Ğ¸Ğ¼Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ğ±Ñ€Ğ¸Ğ·", price: 670, stripe: "stripe-yellow" },
      { id: 5, name: "Ğ¢Ñ€Ğ¾Ğ¿Ğ¸ĞºĞ°Ğ½Ğ°", price: 720, stripe: "stripe-orange" },
      { id: 6, name: "Ğ¡Ğ½Ğ¸ĞºĞµÑ€Ñ", price: 820, stripe: "stripe-cocoa" },
    ];

    /* â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const quantities = {};
    CATALOG.forEach(item => quantities[item.id] = 0);

    /* â”€â”€ DOM References â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const catalogEl = document.getElementById("catalog");
    const summaryEl = document.getElementById("orderSummary");
    const orderBtn = document.getElementById("orderBtn");

    /* â”€â”€ Telegram WebApp â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
      // Match Telegram theme if available
      if (tg.themeParams?.bg_color) {
        document.documentElement.style.setProperty("--bg", tg.themeParams.bg_color);
      }
    }

    /* â”€â”€ Render Catalog â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function renderCatalog() {
      catalogEl.innerHTML = CATALOG.map(item => `
        <div class="card" data-id="${item.id}">
          <div class="stripe ${item.stripe}"></div>
          <div class="card-info">
            <div class="card-name">${item.name}</div>
            <div class="card-price">${item.price} â‚½</div>
          </div>
          <div class="qty-controls">
            <button class="qty-btn minus" data-id="${item.id}" aria-label="Ğ£Ğ¼ĞµĞ½ÑŒÑˆĞ¸Ñ‚ÑŒ">âˆ’</button>
            <div class="qty-value" id="qty-${item.id}">0</div>
            <button class="qty-btn plus" data-id="${item.id}" aria-label="Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ">+</button>
          </div>
        </div>
      `).join("");
    }

    /* â”€â”€ Update UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function updateUI() {
      let totalItems = 0;
      let totalPrice = 0;

      CATALOG.forEach(item => {
        const qty = quantities[item.id];
        const qtyEl = document.getElementById(`qty-${item.id}`);
        if (qtyEl) qtyEl.textContent = qty;
        totalItems += qty;
        totalPrice += qty * item.price;
      });

      if (totalItems > 0) {
        summaryEl.textContent = `${totalItems} ÑˆÑ‚. Ğ½Ğ° ÑÑƒĞ¼Ğ¼Ñƒ ${totalPrice} â‚½`;
        orderBtn.disabled = false;
      } else {
        summaryEl.textContent = "";
        orderBtn.disabled = true;
      }
    }

    /* â”€â”€ Event Handlers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    catalogEl.addEventListener("click", (e) => {
      const btn = e.target.closest(".qty-btn");
      if (!btn) return;

      const id = Number(btn.dataset.id);
      if (btn.classList.contains("plus")) {
        quantities[id] = Math.min(quantities[id] + 1, 99);
      } else if (btn.classList.contains("minus")) {
        quantities[id] = Math.max(quantities[id] - 1, 0);
      }
      updateUI();
    });

    /* â”€â”€ Modal Logic â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    const modalOverlay = document.getElementById("modalOverlay");
    const pickupDate = document.getElementById("pickupDate");
    const timeGrid = document.getElementById("timeGrid");
    const modalConfirm = document.getElementById("modalConfirm");
    const modalCancel = document.getElementById("modalCancel");
    let selectedTime = null;

    // Store schedule: { dayOfWeek: [openHour, closeHour] }, 0=Sun
    const SCHEDULE = {
      1: [12, 20], // Mon
      2: [12, 20], // Tue
      3: [12, 20], // Wed
      4: [12, 20], // Thu
      5: [12, 20], // Fri
      6: [12, 19], // Sat
      // 0 (Sun) â€” closed
    };

    function getMinDate() {
      const d = new Date();
      d.setDate(d.getDate() + 2);
      // Skip to Monday if lands on Sunday
      if (d.getDay() === 0) d.setDate(d.getDate() + 1);
      return d;
    }

    function formatDateISO(d) {
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${y}-${m}-${day}`;
    }

    function renderTimeSlots(dateStr) {
      selectedTime = null;
      modalConfirm.disabled = true;
      timeGrid.innerHTML = '';

      if (!dateStr) return;

      const d = new Date(dateStr + 'T00:00:00');
      const dow = d.getDay();
      const hours = SCHEDULE[dow];

      if (!hours) {
        timeGrid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:var(--text-muted);font-size:0.85rem;padding:12px">Ğ’Ğ¾ÑĞºÑ€ĞµÑĞµĞ½ÑŒĞµ â€” Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹</div>';
        return;
      }

      const [open, close] = hours;
      for (let h = open; h < close; h++) {
        for (let m = 0; m < 60; m += 30) {
          const label = `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}`;
          const slot = document.createElement('div');
          slot.className = 'time-slot';
          slot.textContent = label;
          slot.dataset.time = label;
          slot.addEventListener('click', () => {
            document.querySelectorAll('.time-slot.selected').forEach(s => s.classList.remove('selected'));
            slot.classList.add('selected');
            selectedTime = label;
            modalConfirm.disabled = false;
          });
          timeGrid.appendChild(slot);
        }
      }
    }

    function openModal() {
      const min = getMinDate();
      pickupDate.min = formatDateISO(min);
      pickupDate.value = formatDateISO(min);
      renderTimeSlots(pickupDate.value);
      modalOverlay.classList.add('active');
    }

    function closeModal() {
      modalOverlay.classList.remove('active');
      selectedTime = null;
    }

    pickupDate.addEventListener('change', () => {
      const val = pickupDate.value;
      const d = new Date(val + 'T00:00:00');
      // Block Sundays
      if (d.getDay() === 0) {
        const next = new Date(d);
        next.setDate(next.getDate() + 1);
        pickupDate.value = formatDateISO(next);
      }
      renderTimeSlots(pickupDate.value);
    });

    modalCancel.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', (e) => {
      if (e.target === modalOverlay) closeModal();
    });

    /* â”€â”€ Order Button â†’ Open Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    orderBtn.addEventListener("click", () => {
      if (orderBtn.disabled) return;
      openModal();
    });

    /* â”€â”€ Confirm Order â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    modalConfirm.addEventListener("click", () => {
      if (!selectedTime || !pickupDate.value) return;

      const items = CATALOG
        .filter(item => quantities[item.id] > 0)
        .map(item => ({
          name: item.name,
          quantity: quantities[item.id],
          price: item.price,
        }));

      const totalPrice = items.reduce((sum, i) => sum + i.quantity * i.price, 0);

      const payload = JSON.stringify({
        type: "order",
        items: items,
        total: totalPrice,
        pickup_date: pickupDate.value,
        pickup_time: selectedTime,
      });

      if (tg) {
        tg.sendData(payload);
      } else {
        console.log("Order payload:", payload);
        alert("Ğ—Ğ°ĞºĞ°Ğ· Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½!\n\n" + payload);
      }
    });

    /* â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    renderCatalog();
    updateUI();
  </script>
</body>

</html>